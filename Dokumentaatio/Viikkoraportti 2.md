Viikkoraportti 2
=======

Toisella viikolla tavoitteena oli aloittaa varsinaisen 15-pelin ratkaisu algoritmin koodaaminen. Kävin torstaina kysymässä
muutamia vinkkejä käytännön toteutuksesta. Näistä suurin osa oli sellaisia asioita joita olin jo pohtinut valmiiksi, mutta
halusin niille vielä varmistuksen. Perehdyin ratkaisualgoritmiin torstai-iltai illasta eteenpäin ja sainkin varsin nopeasti
koodattua tehokkaan ratkaisu algoritmin 3x3 -matriisin eli 8-pelin ratkaisemiseen.  Illan päätteeksi kokeilin toimisiko kyseinen algoritmi jo sellaisenaan 4x4 -matriisiin, muttei toiminut. 

Itse algoritmin toiminta on hyvin yksinkertainen: konstruoidaan alkutilanne, josta algoritmi lähtee rakentamaan seuraavia pelitilanteita ja tallentaa niitä kekoon, josta nostetaan seuraavaksi tarkasteltavaksi pelitilanteeksi aina sillä hetkellä optimaallisin. Ongelmaksi muodostui toimivan heuristiikka funktion löytäminen, eli funktion jonka tehtävänä on arvottaa eri pelitilanteet niiden sopivuuden mukaan. Lähdin liikkeelle perinteisellä Manhattan distancella, MD, jossa pelin arvo määritellään sen mukaan kuinka monen "askeleen" päässä kukin pelilaatta on oikeasta paikastaan. Tällä tavoin sain 3x3 matriisit ratkeamaan varsin nopeasti, mutta joidenkin pelitilanteiden kohdalla algoritmi näytti jäävän luuppiin saavutettuaan jonkin MD-arvon. Tämä johtuu todennäköisesti siitä, että pelin konstruoimat uudet pelitilanteet ovat arvoltaan (MD) lähes yhtä arvokkaita kuin edelliset, jonka takia keosta nostetaan uudelleen ja uudelleen lähes identtisiä pelitilanteita.

Algoritmin toimimattomuus 15-pelin kohdalla jäi vaivaamaan todenteolla ja jatkoin perjantaina asiaan paneutumista. Päättelin ja havaitsin käytännön kokeilujen perusteella, että ikävät laskennalliset luupit voi välttää, kun manhattan distancea painottaa tehtyjen siirtojen määrällä. Siis value = MD + siirtojen lukumäärä, jolla pelitilanteeseen on päästy. Tällöin siirtojen lukumäärä alkaa hyvinkin nopeasti dominoimaan value-arvoa ja algoritmi "havaitsee" nopeasti, ettei pelitilanne ole suotuisa. Tällä hyvinkin yksinkertaisella painotuksella sain laskettua laskenta aikaa 3x3 matriisin tapauksessa yli puolella ja saavutin lähestulkoon optimaallisimpia mahdollisia tuloksia. Nopean aika-analyysin perusteella "vaikein" 8-peli, jossa minimi siirtojen määrä on 31, ratkesi keskimäärin 47 millisekunnissa ja ratkaisuun vaadittiin 31 siirtoa eli algoritmi löysi parhaan mahdollisen ratkaisun. Kyseinen heuristiikka toimi myös niiden 15-pelien kohdalla, joiden alkutilanteen MD-arvo oli alle 30. Tätä suurempien MD-arvojen kohdalla algoritmi ei saanut laskettua tehokkaasti ratkaisua, ei edes useamman minuutin aikana. 

15-pelin ongelmaan löytyi lauantaina tunnin netin selailun ja pohdinnan jälkeen ratkaisu: pelitilanteet, joissa pelilaudan yläpuoli on mahdollisimman hyvässä järjestyksessä johtavat usein ratkaisuun. Kun MD-arvon laskennassa sovelsi yläpuolen painottamista alkoivat kaikki pelit, myös vaikeimmat: siirtoja vähintään 81, ratketa tehokkaasti. Valitettavasti ratkaisuun johtavien siirtojen määrä ei ollut kovinkaan optimaallinen. Siirtojen määrää pystyy optimoimaan heuristiikka funktiota muuttamalla. Tällä hetkellä parhaimmaksi kompromissiksi tehokkuuden ja optimisiirtomäärän suhteen on osoittautunut funktio, jossa perinteinen manhattan distance kerrotaan kahdella ja arvoa painotetaan siirtojen määrällä, value = 2*MD + siirrot. Tämä antaa ratkaisuja joiden siirtomäärä on optimin ja n. 1,2 * optimin välillä.
